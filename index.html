<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " vocab="http://ogp.me/ns" lang="en">
<head>

<meta charset="utf-8">

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
<script type="text/javascript" src="/static/js/config.js"></script>
<script type="text/javascript" src="/static/libs/github-api/1.0.0/GitHub.bundle.js"></script>

<script type="text/javascript">
var updateConfig = function(frm) {
  $(frm).children("input").each(function() {
    config[$(this).attr("name")] = $(this).val();
  });
}

var populate = function(frm, data) {  // data is an object, frm is a string selector
  $.each(data, function(key, value){
    $('[name=' + key + ']', frm).val(value);
  });
}

var execute = function() {
  var gh = new GitHub({
     username: config.username,
     password: config.password
  });
  
  var db = gh.getRepo(config.username, config.repo);
  db.getContents(config.branch, "", true).then(
    function(success) {
      $("#error_dir").text("success");
      $("#debug_dir").text(JSON.stringify(success));
    }, function(failure) {
      $("#error_dir").text("failure");
      $("#debug_dir").text(JSON.stringify(failure));
    }
  );
}
  
$(function() {
  populate("#config", config);
});
</script>

</head>
<body>

<div id="config">
  <label for="name">Committer Name</label>
  <input type="text" name="name" value="" />
  
  <label for="email">Committer Email</label>
  <input type="email" name="email" value="" />
  
  <label for="username">Username</label>
  <input type="text" name="username" value="" />
  
  <label for="password">Password</label>
  <input type="password" name="password" value="" />
  
  <label for="repo">Database Repo</label>
  <input type="text" name="repo" value="" />
  
  <label for="branch">Database Branch</label>
  <input type="text" name="branch" value="" />
  
  <button onClick="updateConfig('#config');">Config</button>
</div>

<button onClick="execute();">execute</button>

<div id="error_dir"></div>
<div id="debug_dir"></div>
<div id="data_dir"></div>

<div id="error_add"></div>
<div id="debug_add"></div>
<div id="data_add"></div>

<div id="error_get"></div>
<div id="debug_get"></div>
<div id="data_get"></div>

<div id="error_upd"></div>
<div id="debug_upd"></div>
<div id="data_upd"></div>

<div id="error_del"></div>
<div id="debug_del"></div>
<div id="data_del"></div>

</body>
</html>
